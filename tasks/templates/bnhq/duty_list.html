{% extends "dashboard/css.html" %}
{% load widget_tweaks %}
{% block title %}Duty List{% endblock %}

{% block content %}
<main class="max-w-6xl mx-auto p-6 bg-white rounded-xl shadow mt-10">

       <!-- Back Button -->
        <a href="{% url 'duty_create' company=company %}" 
            class="inline-block bg-blue-600 text-white font-semibold text-2xl px-6 py-2 rounded-lg shadow hover:bg-green-700 transition">
            <-Back
        </a>

    <h2 class="text-3xl font-bold mb-6 text-center">
    {{ company }} Duties list
    </h2>


    {% regroup duties by destination as destination_list %}

    {% for group in destination_list %}
        <!-- Each group wrapped in page-break div -->
        <div class="mb-12 page-break p-6 border rounded-lg shadow-md">

            <!-- Header -->

            <h4 class="text-3xl font-bold text-center mb-2">
                এম সি সি নং - ১৪১০/২
            </h4>
            <h4 class="text-3xl font-bold text-center mb-2">
                কর্তব্যে প্রেরিত পুলিশ অফিসার কর্তৃক বহনীয় হুকুমনামা
            </h4>
            <h4 class="text-2xl font-bold text-center mb-2">
                (নিয়ন্ত্রণ নং ১৬৩ এবং ৯০৯)
            </h4>

            <!-- Right side serial number (first duty in group) -->
            <div class="flex justify-end mb-2 text-2xl">
                <p class="text-xl font-bold">Ser -
                    {% if group.list %}
                        {{ group.list.0.serial_no }}
                    {% endif %}
                </p>
            </div>

            <!-- Form numbers -->
            <div class="flex text-left mb-4 space-x-8">
                <div class="text-xl leading-tight">
                    <p>ফরম নং ...........</p>
                    <p>বাংলাদেশ ফরম নং-5336</p>
                </div>
            </div>

            <!-- Destination -->
            <div class="flex justify-between items-center">
                <!-- বাম পাশে -->
                    <div class="text-xl font-semibold mb-2">
                         Destination: {{ group.grouper }}
                    </div>

                <!-- ডান পাশে -->
                <div class="flex flex-col space-y-1  text-left mx-auto">
                    
                 {% if group.list.0.signature %}
        <img src="{{ group.list.0.signature.url }}" alt="স্বাক্ষর" class="w-32 h-auto mb-2 border">
    {% else %}
        <img src="/path/to/signature.png" alt="স্বাক্ষর" class="w-32 h-auto mb-2 border">
    {% endif %}
                    
                        <span>স্টাফ অফিসার</span>
                        <span>র‌্যাব-১, উত্তরা, ঢাকা।</span>
                </div>
            </div>

            {% regroup group.list by date as date_list %}

            {% for date_group in date_list %}
                <h4 class="text-xl font-medium mb-1">Date: {{ date_group.grouper }}</h4>
                <table class="w-full border-collapse border border-gray-300 mb-4">
                    <thead>
                        <tr class="bg-amber-400 text-left text-xl">
                            <th class="border px-4 py-2">Member No</th>
                            <th class="border px-4 py-2">Name</th>
                            <th class="border px-4 py-2">Rank</th>
                            <th class="border px-4 py-2">Phone</th>
                            <th class="border px-4 py-2">Start Time</th>
                            <th class="border px-4 py-2">End Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for duty in date_group.list %}
                        <tr class="hover:bg-gray-100 text-xl">
                            <td class="border px-4 py-2">{{ duty.member.no }}</td>
                            <td class="border px-4 py-2">{{ duty.name }}</td>
                            <td class="border px-4 py-2">{{ duty.rank }}</td>
                            <td class="border px-4 py-2">{{ duty.phone }}</td>
                            <td class="border px-4 py-2">{{ duty.start_time }}</td>
                            <td class="border px-4 py-2">{{ duty.end_time }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endfor %} 
            <p>
                দ্রষ্টব্য- কোন বিলম্ব হইলে সঙ্গে সঙ্গে শেষ চার কলমের লিখিত বিবরণ খুজিয়া বাহির করিতে হইবে।
                বিলম্বকারীকে অভিযুক্ত করিতে হবে। তদন্তকারী অফিসার তাহার কৈফিয়ত হুকুমনামার পর পৃষ্ঠায় লিখিবেন 
                এবং সুপারের কাছে আদেশের জন্য পাঠাইবেন।
            </p> 

            {% comment %} <h2 class="text-center italic text-green-700 text-xl my-4">
                সিস্টেম-জেনারেটেড স্বাক্ষরের প্রয়োজন নেই
            </h2> {% endcomment %}

        </div>
    {% empty %}
        <p class="text-center">No duties found.</p>
    {% endfor %}

</main>

{% endblock %}
